 --Merge statement helps to Insert new recored and update existing recored if there is a change in source.
--Source Table

Create table dbo.Employee_Src 
(
 EmpCode Int Primary Key,
 FullName Varchar(100),
 Gender      Char(1),
 Location    Varchar(100)
);
--Target Table

Create table dbo.Employee_Trg
(
 Empkey      Int Primary Key,
 EmpCode     Int ,
 FullName Varchar(100),
 Gender     Char(1),
 Location    Varchar(100),
 StartDate   Date,
 EndDate     Date
);

-- Insert records
Insert into dbo.Employee_Src (Empcode,Fullname,Gender,Location)
Values (1001,'Robert Williams','M','Colorado'),
       (1002,'Hanna Joshep','F','Washington')

-- Check records in source table
Select * from dbo.Employee_Src
       
